pipeline {
    agent any
         stages {
           stage('Compile and Clean') {
                steps {
                       sh "mvn -B -f ./cps-rest/pom.xml clean compile"
                       }
                }


            stage('deploy') {
                steps {
                 sh "mvn -B -f ./cps-rest/pom.xml package"
                 }
                  }


        stage('Build Docker image'){
            steps {

                sh 'docker build -t  revature-cps-rest ./cps-rest'

            }
        }


        stage('Backend Deploy'){
            steps {
                sh 'docker container rm -f revature-cps-rest'
                sh 'docker run -d -p  2021:2021 revature-cps-rest'
            }
        }
    }
}
